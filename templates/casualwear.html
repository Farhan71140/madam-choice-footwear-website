{% extends "base.html" %}
{% block content %}

<style>
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(30px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  @keyframes float {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    50%       { transform: translateY(-20px) rotate(3deg); }
  }
  .product-section {
    background: #00c6ff; min-height: 100vh;
    padding: 80px 0; position: relative; overflow: hidden;
  }
  .product-section::before {
    content: ''; position: absolute;
    width: 400px; height: 400px;
    background: rgba(255,255,255,0.1); border-radius: 50%;
    top: -150px; right: -150px;
    animation: float 8s ease-in-out infinite; z-index: 0;
  }
  .product-section::after {
    content: ''; position: absolute;
    width: 300px; height: 300px;
    background: rgba(255,255,255,0.08); border-radius: 50%;
    bottom: -100px; left: -100px;
    animation: float 6s ease-in-out infinite reverse; z-index: 0;
  }
  .product-container { position: relative; z-index: 1; }
  .btn-back {
    background: linear-gradient(135deg, #004080 0%, #0066cc 100%);
    color: white; border: none; padding: 12px 30px;
    font-size: 1rem; font-weight: 600; border-radius: 50px;
    text-decoration: none; display: inline-flex;
    align-items: center; gap: 8px; margin-bottom: 30px;
    transition: all 0.3s ease; box-shadow: 0 5px 20px rgba(0,64,128,0.3);
  }
  .btn-back:hover { transform: translateY(-3px); box-shadow: 0 8px 30px rgba(0,64,128,0.5); color: white; }
  .product-heading {
    font-size: 3rem; font-weight: 800; color: #000;
    text-align: center; margin-bottom: 3rem;
    text-shadow: 2px 4px 8px rgba(255,255,255,0.3);
    animation: fadeInUp 0.8s ease-out;
  }
  .product-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 30px; margin-bottom: 40px;
  }
  .product-card {
    background: #fff; border-radius: 20px; overflow: hidden;
    box-shadow: 0 10px 40px rgba(0,114,255,0.15);
    transition: all 0.3s ease; animation: fadeInUp 0.8s ease-out;
    border: 1px solid rgba(0,114,255,0.1);
    display: flex; flex-direction: column;
  }
  .product-card:hover { transform: translateY(-8px); box-shadow: 0 20px 60px rgba(0,114,255,0.25); }
  .card-img-wrapper { position: relative; overflow: hidden; height: 240px; background: #f8f9fa; }
  .product-img { width: 100%; height: 100%; object-fit: cover; cursor: pointer; transition: transform 0.4s ease; }
  .product-img:hover { transform: scale(1.08); }
  .zoom-hint {
    position: absolute; bottom: 10px; right: 10px;
    background: rgba(0,0,0,0.5); color: white;
    font-size: 0.75rem; padding: 4px 8px;
    border-radius: 20px; pointer-events: none;
  }
  .card-body { padding: 18px; flex: 1; display: flex; flex-direction: column; }
  .product-name { font-size: 1rem; font-weight: 700; color: #1a1a2e; margin-bottom: 6px; }
  .product-price { font-size: 1.6rem; font-weight: 800; color: #004080; margin-bottom: 4px; }
  .delivery-info { font-size: 0.8rem; color: #27ae60; font-weight: 600; margin-bottom: 14px; }
  .selectors-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 14px; }
  .selector-group label {
    font-size: 0.72rem; font-weight: 700; color: #666;
    text-transform: uppercase; letter-spacing: 0.5px;
    display: block; margin-bottom: 5px;
  }
  .selector-group select {
    width: 100%; padding: 8px 10px;
    border: 2px solid #e0e7ff; border-radius: 10px;
    font-size: 0.9rem; font-weight: 600; color: #1a1a2e;
    background: #f8f9ff; cursor: pointer; transition: border-color 0.2s;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23004080' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
    background-repeat: no-repeat; background-position: right 10px center; padding-right: 28px;
  }
  .selector-group select:focus { outline: none; border-color: #0066cc; background-color: #fff; }
  .btn-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: auto; }
  .btn-add-cart {
    background: linear-gradient(135deg, #004080, #0066cc);
    color: white; border: none; padding: 11px 10px;
    font-size: 0.88rem; font-weight: 700; border-radius: 12px;
    cursor: pointer; transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0,64,128,0.3);
    display: flex; align-items: center; justify-content: center; gap: 6px;
  }
  .btn-add-cart:hover { background: linear-gradient(135deg, #002244, #004080); transform: translateY(-2px); }
  .btn-buy-now {
    background: linear-gradient(135deg, #ff6b00, #e65100);
    color: white; border: none; padding: 11px 10px;
    font-size: 0.88rem; font-weight: 700; border-radius: 12px;
    cursor: pointer; transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(255,107,0,0.3);
    display: flex; align-items: center; justify-content: center; gap: 6px;
  }
  .btn-buy-now:hover { background: linear-gradient(135deg, #e65100, #bf360c); transform: translateY(-2px); }
  .modal-content { border-radius: 20px; border: none; overflow: hidden; }
  .modal-header { background: linear-gradient(135deg, #004080, #0066cc); color: white; border: none; }
  .modal-product-img { max-height: 80vh; width: auto; margin: 0 auto; border-radius: 15px; }
  @media (max-width: 768px) {
    .product-heading { font-size: 1.8rem; }
    .product-grid { grid-template-columns: repeat(2, 1fr); gap: 15px; }
    .card-img-wrapper { height: 160px; }
    .card-body { padding: 12px; }
    .product-price { font-size: 1.2rem; }
    .btn-add-cart, .btn-buy-now { font-size: 0.78rem; padding: 9px 6px; }
  }
  @media (max-width: 400px) { .product-grid { grid-template-columns: 1fr; } }
</style>

<div class="product-section">
  <div class="container product-container">

    <a href="/products" class="btn-back">‚Üê Back to Varieties</a>
    <h2 class="product-heading">üëí Casual Wear Collection</h2>

    <div class="product-grid">

      <!-- Pure Gold Soft Maroon -->
      <div class="product-card">
        <div class="card-img-wrapper">
          <img src="{{ url_for('static', path='/images/products/casualwear/puregoldsoftmarronC.jpg') }}"
               class="product-img" alt="Pure Gold Soft Maroon"
               data-bs-toggle="modal" data-bs-target="#imageModal"
               onclick="showImage(this.src, 'Pure Gold Soft Maroon')">
          <span class="zoom-hint">üîç Tap to zoom</span>
        </div>
        <div class="card-body">
          <div class="product-name">Pure Gold Soft Maroon</div>
          <div class="product-price">‚Çπ480</div>
          <div class="delivery-info">‚úÖ Free delivery above ‚Çπ999 | ‚Çπ20/km</div>
          <div class="selectors-row">
            <div class="selector-group">
              <label>üëü Size</label>
              <select id="size-PureGoldSoftMaroon">
                <option value="">Select</option>
                <option>6</option><option>7</option><option>8</option>
                <option>9</option><option>10</option><option>11</option>
              </select>
            </div>
            <div class="selector-group">
              <label>üì¶ Qty</label>
              <select id="qty-PureGoldSoftMaroon">
                <option value="1">1</option><option value="2">2</option>
                <option value="3">3</option><option value="4">4</option>
                <option value="5">5</option>
              </select>
            </div>
          </div>
          <div class="btn-row">
            <button class="btn-add-cart" onclick="handleAddToCart('PureGoldSoftMaroon', 480)">üõí Add to Cart</button>
            <button class="btn-buy-now"  onclick="handleBuyNow('PureGoldSoftMaroon', 480)">‚ö° Buy Now</button>
          </div>
        </div>
      </div>

      <!-- Pink Stone Flat -->
      <div class="product-card">
        <div class="card-img-wrapper">
          <img src="{{ url_for('static', path='/images/products/casualwear/pinkstoneflatC.jpg') }}"
               class="product-img" alt="Pink Stone Flat"
               data-bs-toggle="modal" data-bs-target="#imageModal"
               onclick="showImage(this.src, 'Pink Stone Flat')">
          <span class="zoom-hint">üîç Tap to zoom</span>
        </div>
        <div class="card-body">
          <div class="product-name">Pink Stone Flat</div>
          <div class="product-price">‚Çπ200</div>
          <div class="delivery-info">‚úÖ Free delivery above ‚Çπ999 | ‚Çπ20/km</div>
          <div class="selectors-row">
            <div class="selector-group">
              <label>üëü Size</label>
              <select id="size-PinkStoneFlat">
                <option value="">Select</option>
                <option>6</option><option>7</option><option>8</option>
                <option>9</option><option>10</option><option>11</option>
              </select>
            </div>
            <div class="selector-group">
              <label>üì¶ Qty</label>
              <select id="qty-PinkStoneFlat">
                <option value="1">1</option><option value="2">2</option>
                <option value="3">3</option><option value="4">4</option>
                <option value="5">5</option>
              </select>
            </div>
          </div>
          <div class="btn-row">
            <button class="btn-add-cart" onclick="handleAddToCart('PinkStoneFlat', 200)">üõí Add to Cart</button>
            <button class="btn-buy-now"  onclick="handleBuyNow('PinkStoneFlat', 200)">‚ö° Buy Now</button>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- Image Preview Modal -->
<div class="modal fade" id="imageModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="imageModalLabel"></h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body text-center">
        <img id="modalImage" src="" alt="" class="modal-product-img">
      </div>
    </div>
  </div>
</div>

<script>
  function showImage(src, title) {
    document.getElementById('modalImage').src = src;
    document.getElementById('imageModalLabel').innerText = title;
  }

  function handleAddToCart(name, price) {
    const sizeEl = document.getElementById('size-' + name);
    const qtyEl  = document.getElementById('qty-' + name);
    const size   = sizeEl ? sizeEl.value : '';
    const qty    = qtyEl  ? parseInt(qtyEl.value) : 1;
    if (!size) { alert('‚ö†Ô∏è Please select a size before adding to cart!'); sizeEl.focus(); return; }

    // ‚úÖ Save scroll position
    const scrollY = window.scrollY;

    addToCart(`${name} (Size ${size})`, price, qty);

    // ‚úÖ Restore scroll + reset dropdowns
    requestAnimationFrame(() => {
      window.scrollTo({ top: scrollY, behavior: 'instant' });
      sizeEl.value = '';   // reset size to "Select"
      qtyEl.value  = '1'; // reset qty to 1
    });
  }

  function handleBuyNow(name, price) {
    const sizeEl = document.getElementById('size-' + name);
    const qtyEl  = document.getElementById('qty-' + name);
    const size   = sizeEl ? sizeEl.value : '';
    const qty    = qtyEl  ? parseInt(qtyEl.value) : 1;
    if (!size) { alert('‚ö†Ô∏è Please select a size first!'); sizeEl.focus(); return; }
    addToCart(`${name} (Size ${size})`, price, qty);
    setTimeout(() => { window.location.href = '/pay'; }, 300);
  }
</script>

{% endblock %}